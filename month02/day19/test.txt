select order_id, num, num*price/sum(num*price) from order_item group by order_id